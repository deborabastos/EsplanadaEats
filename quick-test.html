<!DOCTYPE html>
<html>
<head>
    <title>Quick Test</title>
</head>
<body>
    <h1>Teste Rápido</h1>
    <button onclick="runTest()">Testar Avaliação</button>
    <div id="result"></div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="src/firebase-config.js"></script>

    <script>
        async function runTest() {
            const resultDiv = document.getElementById('result');

            try {
                // Create test restaurant
                const restaurantData = {
                    name: 'Teste Rápido',
                    address: 'Teste',
                    phone: '123',
                    category: 'Teste',
                    description: 'Teste',
                    price: 1,
                    averageQuality: 0,
                    createdAt: new Date(),
                    updatedAt: new Date()
                };

                const restaurantRef = await window.EsplanadaEatsFirebase.db.collection('restaurants').add(restaurantData);
                const restaurantId = restaurantRef.id;

                // Test rating update
                const updateData = {
                    averageQuality: 5,
                    averageTaste: 4,
                    averagePrice: 3,
                    averageAmbiance: 4,
                    averageService: 5,
                    averageOverall: 4,
                    totalReviews: 1
                };

                await window.EsplanadaEatsFirebase.db.collection('restaurants').doc(restaurantId).update(updateData);

                resultDiv.innerHTML = '<p style="color: green;">✅ SUCESSO! Atualização de restaurante funciona!</p>';

            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">❌ ERRO: ${error.message}</p>`;
                console.error('Detailed error:', error);
            }
        }
    </script>
</body>
</html>